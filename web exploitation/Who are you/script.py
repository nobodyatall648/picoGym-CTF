#!/usr/bin/python3

import requests
from bs4 import BeautifulSoup

chalURL = 'http://mercury.picoctf.net:46199/'

#refer to list of HTTP headers
headers = {
	#Only people who use the official PicoBrowser are allowed on this site!
	#set the user-agent to PicoBrowser to tell it that it's from official PicoBrowser
	'User-Agent': 'PicoBrowser', 

	#I don't trust users visiting from another site.
	#Referer can be used to tell the website you're visiting from the original mercury.picoctf.net 
	'Referer' : 'http://mercury.picoctf.net:46199/',

	#Sorry, this site only worked in 2018 
	#set the date with 2018 year integer to tell the site it's 2018 right now
	'Date' : '2018', 

	#I don't trust users who can be tracked.
	#DNT (Do not track), set it to 1 to enable it
	'DNT' : '1', 

	#This website is only for people from Sweden.
	#go to shodan find a sweden ip and set the X-Forwarded-For with the IP, this can used to tell the site you're from this IP
	'X-Forwarded-For' : '192.71.125.7', 

	#You're in Sweden but you don&#39;t speak Swedish?
	#set the accept-language to sweedish Sweden
	'Accept-Language' : 'sv-SE' 
}

# sent get request
rsl = requests.get(chalURL, headers=headers)

for line in str(rsl.text).split('\n'):
	#find line that contain picoCTF{...} flag
	if('picoCTF{' in line):
		print("Flag: " + line.strip(), end='\n\n')